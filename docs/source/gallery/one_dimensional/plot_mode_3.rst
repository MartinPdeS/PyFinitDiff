
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/one_dimensional/plot_mode_3.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_gallery_one_dimensional_plot_mode_3.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_one_dimensional_plot_mode_3.py:


Example: 1D eigenmodes 2
========================

.. GENERATED FROM PYTHON SOURCE LINES 8-15

.. list-table:: 1D Finit-difference parameters
   :widths: 25
   :header-rows: 1

   * - boundaries: {left: anti-symmetric, right: anti-symmetric}
   * - derivative: 2
   * - accuracy: 6

.. GENERATED FROM PYTHON SOURCE LINES 15-63

.. code-block:: python3
   :lineno-start: 16


    from scipy.sparse import linalg

    from PyFinitDiff.sparse1D import FiniteDifference1D
    from PyFinitDiff.utils import get_1D_circular_mesh_triplet
    from MPSPlots.Render2D import Scene2D, Axis, Line
    from PyFinitDiff.boundaries import Boundaries1D


    n_x = 200
    sparse_instance = FiniteDifference1D(
        n_x=n_x,
        dx=1,
        derivative=2,
        accuracy=6,
        boundaries=Boundaries1D()
    )

    mesh_triplet = get_1D_circular_mesh_triplet(
        n_x=n_x,
        radius=60,
        value0=1,
        value1=1.4444,
        x_offset=+100
    )

    dynamic_triplet = sparse_instance.triplet + mesh_triplet

    eigen_values, eigen_vectors = linalg.eigs(
        dynamic_triplet.to_dense(),
        k=4,
        which='LM',
        sigma=1.4444
    )

    figure = Scene2D(unit_size=(3, 3), tight_layout=True)

    for i in range(4):
        Vector = eigen_vectors[:, i].real.reshape([sparse_instance.n_x])
        ax = Axis(row=0, col=i, title=f'eigenvalues: \n{eigen_values[i]:.3f}')
        artist = Line(y=Vector)
        ax.add_artist(artist)
        figure.add_axes(ax)

    figure.show()


    # -



.. image-sg:: /gallery/one_dimensional/images/sphx_glr_plot_mode_3_001.png
   :alt: , eigenvalues:  1.442+0.000j, eigenvalues:  1.434+0.000j, eigenvalues:  1.421+0.000j, eigenvalues:  1.403+0.000j
   :srcset: /gallery/one_dimensional/images/sphx_glr_plot_mode_3_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Scene2D(unit_size=(3, 3), tight_layout=True, transparent_background=False, title='')




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.312 seconds)


.. _sphx_glr_download_gallery_one_dimensional_plot_mode_3.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_mode_3.py <plot_mode_3.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_mode_3.ipynb <plot_mode_3.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
